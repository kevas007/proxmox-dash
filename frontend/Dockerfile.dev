# Dockerfile pour le développement frontend
FROM node:20-alpine

# Installer curl pour les health checks
RUN apk add --no-cache curl

# Set working directory
WORKDIR /app

# Copier les fichiers de dépendances
COPY package*.json ./

# Installer toutes les dépendances (y compris devDependencies)
RUN npm ci

# Copier le code source
COPY . .

# Copier les fichiers de traduction vers public/locales (au build)
RUN npm run copy-locales || echo "Note: copy-locales script may fail, continuing..."

# Exposer le port de développement Vite
EXPOSE 5173

# Health check
HEALTHCHECK --interval=30s --timeout=10s --start-period=10s --retries=3 \
  CMD curl -f http://localhost:5173 || exit 1

# Script de démarrage qui copie les traductions puis démarre Vite
CMD ["sh", "-c", "npm run copy-locales && npm run dev -- --host 0.0.0.0 --port 5173"]

