# Guide de r√©solution des probl√®mes - ProxmoxDash

## üö® Probl√®mes courants et solutions

### 1. Erreurs CORS dans la console

#### Sympt√¥mes
```
Access to fetch at 'http://localhost:8080/api/...' from origin 'http://localhost:5173' has been blocked by CORS policy
```

#### Solutions
1. **V√©rifier que le backend est d√©marr√©**
   ```bash
   curl http://localhost:8080/api/health
   ```

2. **V√©rifier la configuration CORS dans config.env**
   ```env
   CORS_ORIGINS=http://localhost:5173,http://127.0.0.1:5173
   ```

3. **Red√©marrer le backend apr√®s modification**
   ```bash
   cd backend && go run ./cmd/main.go
   ```

### 2. Erreurs TypeScript "Cannot read properties of null"

#### Sympt√¥mes
```
Uncaught TypeError: Cannot read properties of null (reading 'filter')
```

#### Solutions
1. **Ajouter des v√©rifications null dans le code**
   ```typescript
   // Au lieu de
   items.filter(...)
   
   // Utiliser
   items?.filter(...) || []
   ```

2. **Initialiser les √©tats avec des valeurs par d√©faut**
   ```typescript
   const [items, setItems] = useState<Item[]>([]);
   ```

### 3. Erreurs de compilation TypeScript

#### Sympt√¥mes
```
Property 'X' does not exist on type 'Y'
```

#### Solutions
1. **V√©rifier les imports**
   ```typescript
   import { useState, useEffect } from 'react';
   // Pas: import React, { useState, useEffect } from 'react';
   ```

2. **V√©rifier les types dans utils/api.ts**
   ```typescript
   export interface App {
     // Tous les champs doivent √™tre d√©finis
   }
   ```

### 4. Backend ne d√©marre pas

#### Sympt√¥mes
```
go: cannot find main module
```

#### Solutions
1. **V√©rifier le r√©pertoire courant**
   ```bash
   cd backend
   go mod tidy
   go run ./cmd/main.go
   ```

2. **V√©rifier les d√©pendances Go**
   ```bash
   go mod download
   ```

### 5. Frontend ne compile pas

#### Sympt√¥mes
```
Module not found: Can't resolve '@/...'
```

#### Solutions
1. **V√©rifier la configuration Vite**
   ```typescript
   // vite.config.ts
   resolve: {
     alias: {
       '@': path.resolve(__dirname, './src'),
     },
   }
   ```

2. **R√©installer les d√©pendances**
   ```bash
   cd frontend
   rm -rf node_modules package-lock.json
   npm install
   ```

### 6. Base de donn√©es SQLite corrompue

#### Sympt√¥mes
```
database is locked
```

#### Solutions
1. **Arr√™ter tous les processus**
   ```bash
   pkill -f "go run"
   ```

2. **Supprimer et recr√©er la DB**
   ```bash
   rm data/app.db*
   # Red√©marrer le backend pour recr√©er la DB
   ```

### 7. Ports d√©j√† utilis√©s

#### Sympt√¥mes
```
bind: address already in use
```

#### Solutions
1. **Trouver et tuer le processus**
   ```bash
   # Windows
   netstat -ano | findstr :8080
   taskkill /PID <PID> /F
   
   # Linux/macOS
   lsof -ti:8080 | xargs kill -9
   ```

2. **Changer le port dans config.env**
   ```env
   PORT=8081
   VITE_API_URL=http://localhost:8081
   ```

### 8. Docker Compose ne d√©marre pas

#### Sympt√¥mes
```
docker: command not found
```

#### Solutions
1. **Installer Docker Desktop**
   - Windows: https://docs.docker.com/desktop/windows/install/
   - macOS: https://docs.docker.com/desktop/mac/install/

2. **Utiliser le mode d√©veloppement sans Docker**
   ```bash
   .\start-dev.ps1  # Windows
   ./start-dev.sh   # Linux/macOS
   ```

### 9. Erreurs d'authentification

#### Sympt√¥mes
```
401 Unauthorized
```

#### Solutions
1. **Utiliser le token de d√©veloppement**
   ```
   Token: dev-token-change-in-production-12345
   ```

2. **V√©rifier la configuration AUTH_TOKEN**
   ```env
   AUTH_TOKEN=dev-token-change-in-production-12345
   ```

### 10. MailHog ne fonctionne pas

#### Sympt√¥mes
```
Connection refused to localhost:8025
```

#### Solutions
1. **D√©marrer avec Docker Compose**
   ```bash
   docker compose up -d mailhog
   ```

2. **V√©rifier la configuration SMTP**
   ```env
   SMTP_HOST=mailhog  # Pour Docker
   SMTP_HOST=localhost  # Pour d√©veloppement local
   ```

## üõ†Ô∏è Commandes de diagnostic

### V√©rifier l'√©tat des services
```bash
# Backend
curl http://localhost:8080/api/health

# Frontend
curl http://localhost:5173/

# MailHog
curl http://localhost:8025/
```

### Logs de d√©bogage
```bash
# Backend Go
cd backend && go run ./cmd/main.go

# Frontend React
cd frontend && npm run dev

# Docker services
docker compose logs -f
```

### Tests de s√©curit√©
```bash
# Windows
.\test-security.ps1

# Linux/macOS
./test-security.sh
```

## üìû Support

### Informations √† fournir en cas de probl√®me
1. **Syst√®me d'exploitation** (Windows/macOS/Linux)
2. **Version de Node.js** (`node --version`)
3. **Version de Go** (`go version`)
4. **Messages d'erreur complets**
5. **√âtapes pour reproduire le probl√®me**

### Commandes de diagnostic
```bash
# Informations syst√®me
node --version
go version
docker --version

# √âtat des ports
netstat -an | grep -E "(8080|5173|8025)"

# Processus en cours
ps aux | grep -E "(go|node|docker)"
```

### Reset complet
```bash
# Arr√™ter tous les services
docker compose down
pkill -f "go run"
pkill -f "npm run dev"

# Nettoyer les fichiers temporaires
rm -rf frontend/node_modules frontend/dist
rm -rf backend/main backend/main.exe
rm -rf data/*.db*

# R√©installer et red√©marrer
.\make.ps1 setup-dev  # Windows
make setup-dev        # Linux/macOS
```

## ‚úÖ Checklist de v√©rification

Avant de signaler un probl√®me, v√©rifiez :

- [ ] Le backend r√©pond sur http://localhost:8080/api/health
- [ ] Le frontend est accessible sur http://localhost:5173
- [ ] Le fichier config.env existe et est configur√©
- [ ] Les d√©pendances sont install√©es (go mod download, npm install)
- [ ] Aucun autre service n'utilise les ports 8080, 5173, 8025
- [ ] Les logs ne montrent pas d'erreurs √©videntes
- [ ] La derni√®re version du code est utilis√©e (git pull)

Si le probl√®me persiste apr√®s ces v√©rifications, consultez la documentation compl√®te ou ouvrez une issue avec les informations de diagnostic.
